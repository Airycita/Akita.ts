"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const context_1=require("../classes/context"),lodash_1=require("lodash");async function default_1(t,o,e){if(!1!==e?.bots||!t.author.bot){const r=new context_1.Context(t),n=o.prefixes?.map(async e=>e.includes("$")?(await o.resolve(e,{metadata:{msg:t,prefix:e,ctx:r}}))?.code:e),i=await n?.find(async e=>t.content.startsWith(await e)),c=o.getCommands("MESSAGE","$any","filter"),f=t.content.trim().split(/ +/g);var a={metadata:{args:f,msg:t,ctx:r}};if("string"==typeof e?.before&&(0,lodash_1.merge)(a,await o.resolve(e.before,a)),c.length)for(const l of c)o.resolve(l.code,a,o);if(i&&(e=t.content.slice(i.length).trim().split(/ +/g).shift()?.toLocaleLowerCase())){var s=o.getCommands("MESSAGE",e,"filter");if(a.metadata.cmd=e,s)for(const d of s)o.resolve(d.code,a,o)}}}exports.default=default_1;