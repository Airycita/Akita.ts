"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.symbols=exports.Utils=exports.dObject=exports.y=exports.mo=exports.w=exports.d=exports.h=exports.m=exports.s=exports.mi_e=exports.m_e=exports.minor=exports.major=exports.not_equal=exports.equal=exports.or=void 0;const tslib_1=require("tslib"),lodash_1=tslib_1.__importStar(require("lodash")),hjson_1=tslib_1.__importDefault(require("hjson")),fs_1=tslib_1.__importDefault(require("fs"));function or(e){try{var s=e.split("||"),t=[];for(const r of s)r.includes("==")?t.push((0,exports.equal)(r)):r.includes("!=")?t.push((0,exports.not_equal)(r)):r.includes(">=")?t.push((0,exports.m_e)(r)):r.includes("<=")?t.push((0,exports.mi_e)(r)):r.includes(">")?t.push((0,exports.major)(r)):r.includes("<")?t.push((0,exports.minor)(r)):t.push(r);return t.some(Boolean)}catch{return null}}require("colors"),exports.or=or;const equal=e=>e.split("==")[0]==e.split("==")[1],not_equal=e=>e.split("!=")[0]!=e.split("!=")[1],major=e=>Number(e.split(">")[0])>Number(e.split(">")[1]),minor=e=>Number(e.split("<")[0])<Number(e.split("<")[1]),m_e=e=>Number(e.split(">=")[0])>=Number(e.split(">=")[1]),mi_e=e=>Number(e.split("<=")[0])<=Number(e.split("<=")[1]);exports.equal=equal,exports.not_equal=not_equal,exports.major=major,exports.minor=minor,exports.m_e=m_e,exports.mi_e=mi_e,exports.s=1e3,exports.m=60*exports.s,exports.h=60*exports.m,exports.d=24*exports.h,exports.w=7*exports.d,exports.mo=30*exports.d,exports.y=365*exports.d,exports.dObject={s:exports.s,m:exports.m,h:exports.h,d:exports.d,w:exports.w,mo:exports.mo,y:exports.y},exports.Utils={falsys:["no","0","null","","void","none","undefined","false"],async LoadFiles(e,s){""!==s?s+="/"+e:s=e;var e=fs_1.default.readdirSync(s,{withFileTypes:!0}).map(e=>(e.name=s+"/"+e.name,e)),t=(0,lodash_1.filter)(e,e=>e.isFile()&&e.name.endsWith(".js"));for(const r of(0,lodash_1.filter)(e,e=>e.isDirectory()))t.push(...await this.LoadFiles(r.name,""));return t},async Invoke(t,e,s,r){const o=e.slice(7).split("->"),i=o.shift(),n=o.join("->").split(",");if(!(0,lodash_1.hasIn)(r,i))return this.Warn("Invalid function key provided",t.data,!0);const a=await lodash_1.default.invoke(r,i,...this.Types(t.data,s||[]));if(o.length)if(1==n.length)await t.setVariable(n[0],a);else{if((0,lodash_1.isNil)(a[Symbol.iterator]))return exports.Utils.Warn("Return value was not iterable",t.data,!0);e=a[Symbol.iterator](),this.Iterate(e,async(e,s)=>{if(n[s].startsWith("..."))return await t.setVariable(n[s].slice(3),a?.slice(s)),!0;await t.setVariable(n[s],e)})}return a},SyncIterate(e,s){let t,r=0;for(;(t=e.next())&&!t.done;)s(t.value,r++,e)},async Iterate(e,s){let t,r=0;for(;(t=e.next())&&!t.done;)await s(t.value,r++,e)},Types(r,e){return e.map(e=>{let s="unknown";var t;if(/(string|unknown|number|bigint|regexp|json|fn):(.*?)/g.test(e)&&(t=e.split(":"),s=(0,lodash_1.lowerCase)(t[0]),e=t.slice(1).join(":")),"string"===s)return e;if("fn"===s)return new Function(e);if("number"===s||"string"!==s&&"bigint"!==s&&!isNaN(e))return Number(e);if("bigint"===s||"string"!==s&&"number"!==s&&!isNaN(e))return BigInt(e);if(["unknown","regexp"].includes(s)&&/\/(.*?)\/(.+|)/g.test(e))return t=e.split("/"),new RegExp(t[1],t[2]);try{return hjson_1.default.parse(e)}catch(t){return"json"==s?exports.Utils.Warn("Invalid JSON provided",r,!0):e}})},Warn(e,s,t=!1){s.code&&=s.code.replace(s.func.id," "),t?(console.error((`${"ERROR".bgRed} -> ${e.gray} ${"in".gray} `+s.func.total.trim().bgRed).gray),s.break=!0):console.log((`${"WARN".bgYellow} -> ${e.gray} ${"in".gray} `+s.func.total.trim().bgYellow).gray)},booleanify(e){var s=Number(e);return isNaN(s)?0<s:!this.falsys.includes(e?.toLowerCase())},condition(condition){try{const ands=condition.split("&&");let results=[];for(const and of ands)and.includes("||")?results=or(and):and.includes("==")?results.push((0,exports.equal)(and)):and.includes("!=")?results.push((0,exports.not_equal)(and)):and.includes(">=")?results.push((0,exports.m_e)(and)):and.includes("<=")?results.push((0,exports.mi_e)(and)):and.includes(">")?results.push((0,exports.major)(and)):and.includes("<")?results.push((0,exports.minor)(and)):results.push(this.booleanify(and));return(0,lodash_1.isNull)(results)?null:(results=condition.includes("||")?results:eval(results.join("&&")),"string"==typeof results?!this.falsys.includes(results):Boolean(results))}catch{return null}},Object(e){try{var s=hjson_1.default.parse(e);return"object"==typeof s?s:null}catch{return null}},ValidateHex(e){return(0,lodash_1.isEmpty)(e)&&/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e.replace(/(#)/g,""))},TimeToMS(e){e=(0,lodash_1.lowerCase)(e).replace(/ +/g,"");var s=Array.from(e.matchAll(/(\d+\.\d+|\d+)(ms|s|mo|d|h|w|m|y)/g));let t=0;if((0,lodash_1.isEmpty)(s)){for(const r of s)t+="ms"===r[2]?Number(r[1]):Number(r[1])*exports.dObject[r[2]];return t}return this.Warn("Invalid time gived",{func:{total:e}},!1),0},async findUser(e,s,t){if(""!==(s=(0,lodash_1.lowerCase)(s).trim())){const r=this.resolveSnowflake(s);if(this.isSnowflake(r))return e.data.client.users.fetch(r).catch(lodash_1.noop);const o=new RegExp(s,t??"gim");return e.data.client.users.cache.find(e=>r===e.id||s===e.toString()||s===e.tag.toLowerCase()||s===e.username.toLowerCase()||o.test(e.tag))}},async findMember(e,s,t){if(""!==(s=(0,lodash_1.lowerCase)(s).trim())){const r=this.resolveSnowflake(s);if(this.isSnowflake(r))return e.members.fetch(r).catch(lodash_1.noop);const o=new RegExp(s,t??"gim");return e.members.cache.find(e=>r===e.id||s===e.toString()||s===e.displayName||s===e.user.tag||s===e.user.username||o.test(e.displayName)||o.test(e.user.username)||o.test(e.user.tag))}},resolveSnowflake(e){return e=e.replace(/[&#@!:<>]/gim,""),Boolean(Number(e))&&e},isSnowflake(e){var s=typeof e;return!(!["number","string"].includes(s)||isNaN(e))&&("number"==s&&(e=e.toString()),/\d{17,20}/.test(e))}},exports.symbols=["K","M","B","T","Qa","Qi","Sx","Sp","O","N","D","UD","UD","DD","TD","QaD","QiD","SxD","SpD","OD","ND","V","UV","DV","TV","QaV","QiV","SxV","SpV","OV","NV","DT","UDT","DDT","TDT","QaDT","QiDT","SxDT","SpDT","ODT","NDT","DQa","UDQa","DDQa","TDQa","QaDQa","QiDQa","SxDQa","SpDQa","ODQa","NDQa","DQi","UDQi","DDQi","TDQi","QaDQi","QiDQi","SxDQi","SpDQi","ODQi","NDQi","DSx","UDSx","DDSx","TDSx","QaDSx","QiDSx","SxDSx","SpDSx","ODSx","NDSx","DSp","UDSp","DDSp","TDSp","QaDSp","QiDSp","SxDSp","SpDSp","ODSp","NDSp","DO","UDO","DDO","TDO","QaDO","QiDO","SxDO","SpDO","ODO","NDO","DN","UDN","DDN","TDN","QaDN","QiDN","SxDN","SpDN","ODN","NDN","C","UC"];